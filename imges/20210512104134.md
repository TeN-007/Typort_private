---
typora-copy-images-to: upload
---

# BugKu   

### web2：

##### 解题思路：直接F12查看源代码得出flag

### 计算机：

##### 解题思路：F12更改网页代码，更改输入框最大输入长度

### web基础GET：

##### 考点：get提交

解题思路：代码分析只要$what=flag就可以获得flag于是在url后面加?what=flag

### web基础$_POST

##### 考点： post提交

解题思路：在火狐浏览器里使用post方式提交what=flag即可，或者使用BP抓包修改

![image-20200729163559328](https://cdn.jsdelivr.net/gh/chenzh66/Typort_private/img/20210512093931.png)

#### POST和GET的区别：

1. post是向服务器传送数据；get是从服务器上获取数据。
2. 在客户端，get是把参数数据队列加到提交表单的ACTION属性所指的URL中，值和表单内各个字段一一对应，在URL中可以看到。post是通过HTTP post机制，将表单内各个字段与其内容放置在HTML HEADER内一起传送到ACTION属性所指的URL地址。用户看不到这个过程。

### 矛盾

##### 考点：字符

解题思路：

1. 题目要求$num=1（只要数值相等就行不在乎类型）但是要求$num又不是数字型，
2. 科学计数法不是数字于是payload：?num=1**1(随便构造一个以1开头的字符串即可)

### web3

##### 考点：弹窗

解题思路：

发现该页面在一直弹窗，分析与js有关，于是先用插件禁用js接着F12查看源代码，在js最底部发现一串疑似URL编码后的注释于是复制解码得到flag（该编码为HTML实体编码，为&#+ASCII码(十进制)）

### 你必须让他停下

##### 考点：BP抓包 repeater重发器的使用

解题思路：

首先打开页面发现它一直加载，于是使用BP抓包，并放到重发器去，在里面测试发送，发现每次发送返回的图片不一样，那么应该就是与图片相关，就一直go，终于刷到了10.jpg获得flag

### 变量1

##### 考点:$	

$GLOBALS定义：引用全局作用域中可用的全部变量（一个包含了全部变量的全局组合数组。变量的名字就是数组的键）

解题思路：

先是对传入的参数进行了过滤，只有传入全字母时才行，但是语句却加了2个$$符这就会导致传入flag后$args=flag $$args=$flag 但是里面没有这个变量，于是调动后便会传回null，所以传入GLOBALS，这样$$args=$GLOBALS。调用$GLOBALS则会返回全部变量的全局组数组，就是返回所有的全局变量。得到flag

### web5

##### 考点：jother编码

解题思路：

进去发现提示js，并且有输入框判断为xss，但是无论输入什么都是返回再好好看看，F12看源代码发现一堆([[!])这样的东西百度后发现是jother编码为javascript的一种的一种编码，将之复制到conscious上回车就可以解码得到flag![image-20200729213927839](https://cdn.jsdelivr.net/gh/chenzh66/Typort_private/img/20210512094846.png)

最后将flag字母大写提交

### 头等舱

##### 考点：BP抓包，观察仔细

解题思路：

1. 无论在url后面加什么都是什么也没，查看源代码也是同样，先到题目叫头等舱，所以初步判断与响应头有关，于是BP抓包放到request里面发送在响应头下面找到flag

![image-20200730103659893](https://cdn.jsdelivr.net/gh/chenzh66/Typort_private/img/20210512103508.png)

### 网站被黑

##### 考点：后台扫描，后门

解题思路

1. 网址中有webshell，是网页有后面的标志，在网页后面加index.php，发现还是现实这个网页于是判断为PHP编写，使用御剑（国产软件，简单方便，扫描能力取决于字典大小）扫描网页，发现了还有一个shell.php![image-20200730111220774](https://cdn.jsdelivr.net/gh/chenzh66/Typort_private/img/20210512103617.png)
2. 打开发现有一个密码框需要输入密码，我们随便输入一个密码用BP抓包发送到intruder选用BP自带的password字典来爆破，最后爆出密码hack![image-20200730111234772](https://cdn.jsdelivr.net/gh/chenzh66/Typort_private/img/20210512103633.png)

### 管理员系统

##### 考点：base64解码 X-Forwarded-For

解题思路：

1. 查看源代码，发现下面注释了一段字符串，看着像base64加密后的于是拿去解密获得test123估计应该是密码，那么用户名可能是admin
2. 输入后提示IP禁止访问，练习本地管理员登录。应该限制了发送访问请求的IP，既然它说本地，我们就使用127.0.0.1，先到了X-Forwarded-For（简称XFF头，它代表客户端，也就是HTTP的请求端真实的IP）在BP中重发器或者直接添加X-Forwarded-For 后面跟127.0.0.1，表示包是127.0.0.1发送的访问请求（X-Forwarded-For: 127.0.0.1）最好在headers里面输入，点go或者发送包就得到了flag，提交flag时需要加上flag的格式。

### web4

##### 考点：解码

解题思路：

1. 提示是看看源代码，于是便看源代码，发现了一长串结果编码后的东西，形式为%xxx于是用url解码
2. 得到了一串代码，最后一行就是要我们将p1，p2，还有一个个字符串连接在一起，于是得到payload输入

### flag在index里面：

##### 考点：文件包含

解题思路：

1. 点击连接发现跳转到show.php页面，发现url上为?file=show.php所以存在文件包含
2. 题目说flag在index里面，于是直接使用?file=php://filter/read=convert.base64-encode/resource=index.php 得到一串字符，使用base64解码得到flag

### 输入密码得到flag

##### 考点：密码爆破

解题思路：

1. 题目要求输入5位数密码，自然而然就想到了BP爆破，于是抓包使用BP爆破，设置为10000到999999步长为一，最后得到结果输入得到flag

### 备份是个好习惯

##### 考点：备份文件的格式，MD5

解题思路：

1. 题目说备份估计是让我们找备份文件,(.bak)文件，于是查看index.php.bak发现下载，下载后用sublim打开

2. ![image-20200730161942541](https://cdn.jsdelivr.net/gh/chenzh66/Typort_private/img/20210512103709.png)

3. 利用==比较漏洞

   如果两个字符经MD5加密后的值为 0exxxxx形式，就会被认为是科学计数法，且表示的是0*10的xxxx次方，还是零，都是相等的。下列的字符串的MD5值都是0e开头的：

    s1665632922a	s878926199a	s155964671a	s214587387a	s214587387a	QNKCDZO	240610708

   另外：MD5(“240610708”)==md5(“QNKCDZO”)（也是0e开头）
   
   构造payload?kekeyy1=QNKCDZO&kekeyy2=240610708(& and的意思，一次性传入2个值)

### 成绩单

##### 考点：SQL注入

解题思路：

1. 看题目是查询成绩，判断与数据库有关，于是尝试爆数据库
2. 爆数据库，爆表，爆列，由于是post提交，在post下面提交，并且不用带?
3. 爆数据id=-1' union select 1,2,group_concat(skctf_flag),4 from fl4g--+

### 秋名山老司机

##### 考点：时间戳，正则表达式

解题思路：

1. 题目要求在2s内计算给出的式子，刷新一下提示通过post方式提交答案，于是想2s内计算出答案只能通过脚本
2. ![image-20200810161137781](https://cdn.jsdelivr.net/gh/chenzh66/Typort_private/img/20210512103715.png)
3. ![image-20200810162252234](https://cdn.jsdelivr.net/gh/chenzh66/Typort_private/img/20210512103721.png)

### 速度要快

##### 考点：解密，数据类型转化

解题思路：

1. 打开网页看，，发现一句话：我感觉你得快点，一脸懵逼，于是查看F12发现，有一句注释掉的，让我们用post方式提交maright
2. 先抓包看看，在header里发现了flag，但是被加密了，于是拿去base64解密得到一句话：跑的不错，给你flag拿去提交，发现是错误的，接着发现每次点GO返回的flag值竟然是不一样的
3. 所以可能是将这个解密后通过post传给margin，于是试了一下发现提示都说了让你快点
4. 最后借助脚本
5. ![image-20200810160826842](https://cdn.jsdelivr.net/gh/chenzh66/Typort_private/img/20210512103929.png)
6. flag解密后，将冒号后的再进行一次解密才是margin的值，相当于是加密了2次，显示尝试了仅一次解密后发现还是不行，于是想着可能还有一层加密，于是给解密后的再进行一次解密得到一串数字，就是真正的margin的值，传上去得到flag

### cookies欺骗

#### 考点：filename，加密

解题思路：

1. 打开网页发现一串很长的字符串，研究好久后发现好像没什么用
2. 看到url中的filename后面跟的好像是base64加密后的，先拿去解密，解密后得到keys.txt
3. 尝试用filname来包含index.php，看filename后面加密了，于是先将index.php用base64加密，再放入filname里面，看到前面还有一个line（行）的参数，于是尝试在后面加数字，发现有东西显示，可能是代码，一个个输复制太麻烦，于是使用Python脚本来获取代码![image-20200815101923874](D:\安全\CTF题目\Bugku\image-20200815101923874.png)
4. 看到代码，发现是要求我们使用cookie的方式提交margin=margin，之后才能看keys.php
5. 这时将keys.php通过加密后放到filename里面来包含，之后再使用cookie的方式来提交margin=margin，发现是空白的网页，查看源代码看看，发现了被注释的flag

### never give up

##### 考点：编码解码，url前面view-source，查看网页源代码

解题思路：

1. 打开给的链接，出来一句千万千万不要放弃的英文外什么都没有，于是F12查看源代码，

2. 发现了一个1p.html，于是访问1p.html看看，发现直接跳转到bugku的网站上面，于是猜测，解题关键可能再1p.html这个网页的源代码上，但是它直接跳转F12查看不了

3. 于是在url前面加上view_source查看该网页的源代码（[view-source:http://123.206.87.240:8006/test/1p.html](view-source:http://123.206.87.240:8006/test/1p.html)）

4. 发现了一段类似url编码后的，于是复制去url解码![image-20200810220652074](D:\安全\CTF题目\Bugku\image-20200810220652074.png)

5. ，得到一串字母，发现该串字母可能被base64加密了，于是拿去解密，有得到了一串url编码后的字符串，于是再拿去url解密，得到了一串代码![image-20200810220910159](D:\安全\CTF题目\Bugku\image-20200810220910159.png)

6. **说明：tripos(字符串a，字符串b)** 函数查找字符串b在字符串a中第一次出现的位置（不区分大小写）。

   **file_get_contents** 将整个文件读入一个字符串

   **strlen()** 函数返回字符串的长度

   **substr()** 函数返回字符串的一部分。 **substr(string,start,length)** ，length参数可选。如 substr($b,0,1) 就是在参数b里面 ，从0开始返回1个长度的字符串

   **eregi("111".substr($b,0,1),"1114")**  就是判断"1114"这个字符串里面是否有符合"111".substr($b,0,1)这个规则的

    总的来说，如果a参数传入文件内有 "bugku is a nice plateform!"字符串，并且id参数为0 ， b参数长度大于5，"1114"这个字符串里面是否有符合"111".substr($b,0,1)这个规则的，substr($b,0,1)不能等于4  以上这些条件都满足，就请求 f4l2a3g.txt

7. 这么麻烦，看看能不能直接访问f4la3g.txt文件

8. 于是直接访问该文件得出flag

### 字符？正则？

#### 考点：正则表达式

1. 打开网页，给到我们一个源代码，它用了正则表达式过滤，如果传入的数据满足正则表达式那么输出flag，传参为id
2. key.*key（key开头，星号为匹配一个或者多个字符，接着以key结尾）{4,7} （匹配任意4到7个字符）key:（匹配key:）\/.\/（/任一字符/）[a-z]（匹配a到z间任一字符）[[:punct:]]（匹配（!"#$%&'() *+,-./:;<=>?@[\]^_`{|}~.））
3. ![image-20200811174117736](D:\安全\CTF题目\Bugku\image-20200811174117736.png)

### 你从哪里来

#### 考点：Referer伪造

解题思路：

1. 打开地址，发现 are you from google，于是想到他可能是要来自Google的请求，于是想到Referer可以伪造发送的请求，（即告诉服务器自己是从哪里来的）
2. 于是在host下面加上    referer:https://www.google.com![image-20200812155155169](D:\安全\CTF题目\Bugku\image-20200812155155169.png)

### md5 collision(NUPT_CTF)

#### 考点：md5碰撞

解题思路:

1. 打开网址后让我们提交参数a，就没有任何提示了，之后便试着传参a=1返回false
2. 仔细 看题目，是md5碰撞，于是想到0e是0乘以10的多少次方，于是给a传解密后0e开头的md5加密得到flag
3. 有： s1665632922a	s878926199a	s155964671a	s214587387a	s214587387a	QNKCDZO	240610708等。但是输入QNKCDZO不行，其它可以，判断可能是里面有一个参数是=QNKCDZO，a传入的值是和那个参数比较的。

### 程序员本地网址

#### 考点：xff伪造

解题思路：

1. 打开后要求我们本地访问，于是想到可以伪造xff为本地就可以了
2. 于是BP抓包在里面添加X-Forwarded-For:127.0.0.1得到flag

### 各种绕过

#### 考点：哈希函数中的SHA1

解题思路：

1. 打开网址得到一段代码，分析如下![image-20200812172004937](D:\安全\CTF题目\Bugku\image-20200812172004937.png)
2. sha1加密要求参数不能为数组，如果我们2个都传入数组那么都是false那就相同了
3. 于是构造payload，得到flag（一个参数是get方式一个是post方式）![image-20200812172155887](D:\安全\CTF题目\Bugku\image-20200812172155887.png)
4. sha1加密后0e开头的有aaroZmOk，aaK1STfY，aaO8zKZF，aa3OFF9m，但是该题不能用，因为中间为三个等号，如果是2个等号的话那就是弱比较，就可以通过0e开头来绕过

### web8

#### 考点：file_get_contents函数和trim函数

解题思路：

1. 打开发现是一段PHP代码，解读如下![image-20200813204926247](D:\安全\CTF题目\Bugku\image-20200813204926247.png)
2. 题目提示flag，于是尝试访问flag.txt，发现有这个文件，里面的内容为flags，于是构造payload：?ac=flags&fn=flag.txt

### 细心

#### 考点：御剑后台扫描，题目联想

解题思路：

1. 打开网址后，得到找不到404无此文件目录等，题目提示想办法变为admin，F12发现有一个div的id=main，开始认为是将其改变，后来想想一个不可能
2. 之后看到它给出的kangle/3.5.5，点击，会跳转，于是去百度kangle3.5.5有什么漏洞没有，发现并没有什么太大的漏洞，接着尝试的使用御剑后台扫描看看还有没有什么其他隐藏的文件
3. 发现了还有robots.txt，用来存放爬虫规则的，指定该网站中不想被搜索引擎访问的部分(不允许的往Disallow: 　后面加)，于是访问robots.txt![image-20200814101235610](D:\安全\CTF题目\Bugku\image-20200814101235610.png)
4. 获得了resusl.php这个文件，访问该文件![image-20200814101547659](D:\安全\CTF题目\Bugku\image-20200814101547659.png)
5. 弹出该网页，上面提示不是管理员，想可能要xff伪造头部，但是无论是改为111.1.214.148还是127.0.0.1，还是其他的都不行，于是将目光放到下面的代码上，要求传入的x和password相等，后来联想到题目的提示改为admin，于是尝试x=admin，得到flag![image-20200814101641513](D:\安全\CTF题目\Bugku\image-20200814101641513.png)
6. ![image-20200814102537009](D:\安全\CTF题目\Bugku\image-20200814102537009.png)

### 求getshell

#### 考点：上传漏洞,绕过

解题思路：

1. 题目要求上传的文件不能是php，先尝试上传一个一句话木马，并将类型改为image/jpeg，发现不行，被过滤了显示无效文件。
2. 之后尝试上传.htaccess文件，发现成功上传但是后缀变为了jpg，之后又上传了.png的图片,发现又变成了.jpg的图片，其它绕过也不行，怀疑存在walf，
3. 多次尝试后发现将content-Type后的字母大小写就可以绕过（修改提交后回显You got it）![image-20200815152812408](D:\安全\CTF题目\Bugku\image-20200815152812408.png)
4. 绕过walf后，上传php文件，将类型改为image/jpeg上传成功，但是后缀又变为.jpg。问题应该出现在后缀上，于是尝试不同的后缀，intruder不行于是利用bp的request一个个尝试，最后发现后缀为.php5后上传得到了flag

### flag.php

#### 考点：序列化，反序列化，cookie提交

解题思路：

1. 打开页面后点击login没有反应，查看源代码也没啥不对劲，用御剑扫描也没有结果，就很奇怪了。再次审题，发现提示hint，于是猜测可能会与hint.txt或hint.php啥的，发现都没有
2. 最后猜想有没有可能是GET 提交，于是?hint返回一个页面，里面有PHP源代码，分析如下![image-20200815174155741](D:\安全\CTF题目\Bugku\image-20200815174155741.png)
3. unserialize反序列化，可以通过serialize序列化函数来构造出供反序列化解的字符串。接下来就是$KEY对于什么的问题，一开始在最下面有看到一段PHP代码![image-20200815174555896](D:\安全\CTF题目\Bugku\image-20200815174555896.png)
4. 就以为$KEY等于这个，后来发现不行，于是想上面没有定义这个$KEY,那是不是可能就是为空于是尝试了下发现成功出来flag![image-20200815175542439](D:\安全\CTF题目\Bugku\image-20200815175542439.png)
5. 使用serialize来构造对于的需要反序列化解的式子![image-20200815175351693](D:\安全\CTF题目\Bugku\image-20200815175351693.png)
6. 构造出来的序列化后面的分号;需要将之转化为url编码，不然会报错;=%3B![image-20200815175657361](D:\安全\CTF题目\Bugku\image-20200815175657361.png)

### Trim的日记本

#### 考点：御剑

解题思路：

1. 打开网页，发现一个页面，下面显示数据库连接失败，随便输入什么登陆，发现什么都不行，于是点注册，点OK后返回的页面线路一句话：数据库连接失败，无论怎么试都是这样，尝试在框框里输入SQL语言，不行
2. 之后尝试抓包，也没发现什么，接着尝试一下御剑后台扫描，扫描到3个网页![image-20200819111357831](D:\安全\CTF题目\Bugku\image-20200819111357831.png)
3. 第一个，第二个都是登录注册页面，第三个打开得到了一个flag，上面显示上面真真假假，难道是flag是假的？不管了先去试一下，发现是真的flag





# 杂项

### 签到题

#### 关注公众号得到flag

### 这是一张单纯的图片

#### 考点：观察

解题思路：

1. 打开后知识一张图片，下载下来后使用winhex打开,发现没什么不同，修改长宽也没有，后来拉到最下面，发现了以串HTML编码后的字符串，拿去解码，得到flag
2. 或者使用记事本打开，拉到最底下，得到编码串拿去解码得到flag

### 隐写

#### 考点：图片隐写

解题思路：

1. 下载得到一张图片，用winhex打开，发现长宽不一样，于是将宽长也修改为F4![image-20200819115322086](D:\安全\CTF题目\Bugku\image-20200819115322086.png)
2. 保存，打开图片，下面就显示了flag

### telnet

#### 考点：跟踪数据流

解题思路

1. 下载的文件使用wireshark打开，ctrl+F查找flag在第一个包中发现tcp.flag![image-20200819125804273](D:\安全\CTF题目\Bugku\image-20200819125804273-1598847438593.png)
2. 于是右键追踪TCP数据流，在里面发现flag

### 眼见非实(ISCCCTF)

#### 考点：zip的文件头

解题思路：

1. 下载来一个名字为zip的文件，没有任何后缀，使用windex打开，发现是50 4B开头的，之前做到题目，50 4B开头的为zip压缩文件，再联想到文件名叫zip于是将之该为zip.zip并解压
2. 解压得到一个文档，打开文档，发现一串代码，像winhex旁边显示的格式，开头为PK，猜测可能还是zip用windex打开果然开头还是50 4B
3. 于是将后缀改为.zip解压后得到一堆文件，就懵了，好多。
4. 在解压缩的文件夹里使用搜素，搜索flag默认是搜索文件，在搜索哪一框里的高级选项，勾选文件内容即可![image-20200819152242182](D:\安全\CTF题目\Bugku\image-20200819152242182.png)
5. 搜索到的是一个叫document.xml的文件中，于是打开找到了flag



### 啊嗒

#### 考点：kali中dd拆分，binwalk分析文件，文件组合

解题思路：

1. 下载得到一张图片，使用winhex打开，发现怪怪的，发里面用00分割了好多个文件一样，就好像是一张图片里还包含了好多个文件
2. 于是使用kali里的binwalk命令来分析该文件，发现了4大块的文件，![image-20200819204331711](D:\安全\CTF题目\Bugku\image-20200819204331711.png)
3. 我们使用dd命令来分割ada.jpg来提取zip文件，dd if=ada.jpg(从这个文件里) of=ada.zip(分出一个文件叫这个) skip=218773(从第几个字段开始分割) bs=1(截取一个块的内容) ![image-20200819204555430](D:\安全\CTF题目\Bugku\image-20200819204555430.png)
4. 得到一个zip文件解压发现要密码，于是接着找，查看了另外3块的内容，但是没有找到密码
5. 最后在图片的属性里面的详细信息里面那个照相机型号，是一串字母，有点奇怪，就拿去解密，十六进制转ASCII码，得到了一串字符串，拿去尝试解密，最后解密成功得到flag

### 又一张图片，还单纯吗

#### 考点：kali中binwalk命令和dd命令

解题思路：

1. 下载图片用winhex打开，发现里面应该包含有好多个不同的文件
2. 于是使用kali里的binwalk命令查看，发现果然有好几个文件![image-20200819215352603](D:\安全\CTF题目\Bugku\image-20200819215352603.png)
3. 使用dd命令将之全部分离出来发现一张关于flag的图片，得到flag![image-20200819215428438](D:\安全\CTF题目\Bugku\image-20200819215428438.png)



### 猜

#### 考点：猜

解题思路：

1. 给了一张图片，提示说flag是一个人的名字拼音，百度识图，图片上的是刘亦菲，于是得到flag：flag{liuyifei}

### 隐写2

#### 考点：文件隐藏，暴力破解，binwalk，dd

解题思路：

1. 下载得到一张图片，使用winhex打开，一看就发现里面包含了好几个文件
2. 放到kali里面，使用binwalk命令，分析该文件，果然里面还包含了一个zip文件
3. 接着使用dd命令来分割文件命令：dd if=Welcome_.jpg of=1.zip skip=52516 bs=1![image-20200820172916692](D:\安全\CTF题目\Bugku\image-20200820172916692.png)
4. 提取出zip文件，解压后，得到一张图片和一个加密 的压缩文件，是真的压缩，不是伪压缩，图片是提示，最上面一句是3位数密码，下面一堆废话，直接ARCHPR暴力破解得到密码，解压后得到一张图片
5. 用winhex打开拉到最底部，得到flag，但是flag里面的内容经过了base64加密
6. 使用base6将内容解密后，套入flag得到flag

### 多种方法解决

#### 考点：img格式

解题思路：

1. 下载得到一个KEY.exe但是打不开，于是使用winhex打开发现里面是图片的代码
2. 所以可以通过DW设置一个div在里面img标签，src=winhex里面图片的代码，再用浏览器打开就可以看到一个二维码，扫描得到flag![image-20200820202306320](D:\安全\CTF题目\Bugku\image-20200820202306320.png)

### 闪的好快

#### 考点：gif一帧一帧分析

解题思路：

1. 题目给出的文件是一个gif图片，用wps图片查看器打开，一帧一帧扫描二维码，将文本内容拼接在一起就是flag

### 白哥的鸽子

考点：栅栏密码，jpg格式

解题思路

1. 下载得到一个名为jpg的文件，没有后缀，使用winhex打开
2. 发现其开头为FF D8 FF E0为jpg格式的文件，于是将之后缀命名为jpg，得到一个白鸽的图片。之后，放入kali里使用binwalk命令查看，没有隐藏文件。
3. 再使用stegsolve查看是否有隐藏，但是没有。
4. 后来还是用winhex打开，看到结尾，发现有花括号，flag等的乱码。于是先将其复制出来。
5. 仔细研究后，发现这是栅栏密码，8位一组，拿去解密得到flag。